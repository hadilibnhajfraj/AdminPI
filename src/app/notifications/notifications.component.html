<div class="form-container">
  <h2>Liste des Tournois</h2>
<!-- Popup d'animation -->
<div *ngIf="popupVisible" class="popup-overlay">
  <div class="popup-box">
    <div class="clock-loader"></div>
    <p>{{ popupMessage }}</p>
  </div>
</div>


<div *ngIf="popupBracketVisible" class="popup-overlay">
  <div class="popup-box bracket-popup">
    <button class="close-button" (click)="fermerPopupBracket()">×</button>
    <h3 class="bracket-title">Arbre du tournoi : {{ nomTournoi }}</h3>
    <div class="bracket-wrapper">
      <div class="bracket">
        <!-- Affichage des tours -->
        <div class="round" *ngFor="let round of rounds">
          <!-- Affichage des matchs pour chaque tour -->
          <div class="match" *ngFor="let match of round">
            <!-- Match équipe 1 -->
            <div class="team">
              <!-- Vérifier si l'équipe existe et afficher son nom -->
              {{ match.equipes1?.[0]?.nom || 'Équipe 1' }}
              <!-- Vérifier si le score existe avant de l'afficher -->
              <span *ngIf="match.scoreEquipe1 !== null">{{ match.scoreEquipe1 }}</span>
            </div>

            <!-- Match équipe 2 -->
            <div class="team">
              <!-- Vérifier si l'équipe existe et afficher son nom -->
              {{ match.equipes1?.[1]?.nom || 'Équipe 2' }}
              <!-- Vérifier si le score existe avant de l'afficher -->
              <span *ngIf="match.scoreEquipe2 !== null">{{ match.scoreEquipe2 }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>



  <!-- Message de confirmation ou d'erreur -->
  <div *ngIf="message" [ngClass]="{'success': !isError, 'error': isError}" class="popup">
    {{ message }}
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Nombre d'Équipes</th>
        <th>Nombre d'Équipes Restantes</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let tournoi of tournois">
        <td>{{ tournoi.nom }}</td>
        <td>{{ tournoi.nbEquipe }}</td>
        <td>{{ tournoi.nbEquipeRestant }}</td>
        <td>
          <!-- Bouton pour afficher les détails du tournoi -->
          <button class="btn btn-info" (click)="afficherDetails(tournoi)">Afficher Détails</button>
          <button class="btn btn-secondary" (click)="afficherBracket(tournoi)">
            Voir l’arbre du tournoi
          </button>
          

          <button class="btn btn-primary" [routerLink]="['/tournoi', tournoi.idTournoi, 'equipes']">
            Voir les équipes
          </button>

          <!-- Bouton pour générer le planning, activé uniquement si nbEquipeRestant == 0 -->
          <button *ngIf="tournoi.nbEquipeRestant === 0" class="btn btn-generate"
            (click)="genererPlanning(tournoi)">
            Générer Planning
          </button>
<!-- Bouton pour générer le planning de championnat (affiché uniquement si aucune équipe restante) -->
<button *ngIf="tournoi.nbEquipeRestant === 0 && !tournoi.hasMatchs" class="btn btn-success"
  (click)="genererChampionnat(tournoi)">
  Générer Planning Championnat
</button>


          <button *ngIf="tournoi.hasMatchs" class="btn btn-warning"
            [routerLink]="['/tournoi', tournoi.idTournoi, 'matchs']">
            Voir les matchs
          </button>
          <!-- Bouton pour voir les matchs de championnat -->
<button *ngIf="tournoi.hasMatchs" class="btn btn-dark"
[routerLink]="['/tournoi', tournoi.idTournoi, 'championnat']">
Voir match championnat
</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
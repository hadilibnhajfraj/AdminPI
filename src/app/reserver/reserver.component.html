<div class="reservation-container">
  <h1 class="reservation-title">Réservez vos places!!!</h1>

  <!-- Section des boutons -->
  <div class="button-section">
    <button class="reservation-button" (click)="showList('tournoi')">🎟️ Abonnements</button>
    <button class="reservation-button" (click)="showList('match')">🎫 Tickets</button>
  </div>
  <!-- Grille des tournois -->
  <div *ngIf="activeList === 'tournoi'" class="tournoi-grid">
    <div *ngFor="let t of tournois" class="tournoi-card" [ngClass]="{ 'sold-out': soldOutMap[t.idTournoi] }"
      (click)="ouvrirDetailsTournoi(t)">
      <div class="tournoi-content">
        <div class="tournoi-info">
          <h2>{{ t.nom | uppercase }}</h2>
          <p>📅 Du {{ t.dateDebut | date:'dd/MM/yyyy' }} au {{ t.dateFin | date:'dd/MM/yyyy' }}</p>
        </div>
        <div class="sold-out-overlay" *ngIf="soldOutMap[t.idTournoi]">
          SOLD OUT
        </div>
      </div>
    </div>
  </div>

  <!-- Liste des matchs -->
  <div *ngIf="activeList === 'match'" class="tournoi-grid">
    <div *ngFor="let m of matches" class="tournoi-card" (click)="ouvrirFormulaire(m.id)">
      <div class="match-content">
        <div class="match-info">
          <h2>{{ m.nomEquipe1 | uppercase }} VS {{ m.nomEquipe2 | uppercase }}</h2>
          <p>🗓️ {{ m.dateDebut | date:'dd/MM/yyyy' }} - ⏰ {{ m.heureDebut }}</p>
          <p>🏟️ {{ m.nomTerrain }} - {{ m.adresseTerrain }}</p>
          <p *ngIf="m.nomTournoi">🏆 Tournoi: {{ m.nomTournoi }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div *ngIf="showModal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h2>Réserver pour le match</h2>
        <button class="close-button" (click)="fermerFormulaire()">×</button>
      </div>
      <div class="modal-body">
        <form [formGroup]="reservationForm" (ngSubmit)="submitReservation()">
          <div class="form-group">
            <label>Nom <span class="required">*</span>:</label>
            <input formControlName="nom" type="text" required />
            <div class="error"
              *ngIf="reservationForm.get('nom')?.hasError('required') && reservationForm.get('nom')?.touched">
              Le nom est requis.
            </div>
            <div class="error"
              *ngIf="reservationForm.get('nom')?.hasError('pattern') && reservationForm.get('nom')?.touched">
              Le nom doit contenir uniquement des lettres.
            </div>
          </div>
          <div class="form-group">
            <label>
              Prénom <span class="required">*</span>:
            </label>
            <input formControlName="prenom" type="text" required />
            <div class="error"
              *ngIf="reservationForm.get('prenom')?.hasError('required') && reservationForm.get('prenom')?.touched">
              Le prénom est requis.
            </div>
            <div class="error"
              *ngIf="reservationForm.get('prenom')?.hasError('pattern') && reservationForm.get('prenom')?.touched">
              Le prénom doit contenir uniquement des lettres.
            </div>
          </div>
          <div class="form-group">
            <label>
              Email <span class="required">*</span>:
            </label>
            <input formControlName="email" type="email" required />
            <div class="error"
              *ngIf="reservationForm.get('email')?.hasError('required') && reservationForm.get('email')?.touched">
              L'email est requis.
            </div>
            <div class="error"
              *ngIf="reservationForm.get('email')?.hasError('email') && reservationForm.get('email')?.touched">
              Veuillez entrer une adresse email valide.
            </div>
          </div>
          <div class="form-group">
            <label>Zone ID:</label>
            <input formControlName="zoneId" type="number" required />
          </div>
          <div class="form-group">
            <label>Nombre de places:</label>
            <input formControlName="nombrePlaces" type="number" min="1" max="5" required />
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" type="submit" [disabled]="reservationForm.invalid">Envoyer</button>
            <button class="btn btn-secondary" type="button" (click)="fermerFormulaire()">Annuler</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>